<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="JPP Ironstone" Language="1033" Version="!(bind.fileVersion.IronstoneCore.dll)" Manufacturer="JPP Consulting" UpgradeCode="a2ad53a9-cf9a-4d4d-88c7-6e6b2dc11075">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" Platform="x64" />

	  <UIRef Id="WixUI_Minimal" />

		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<MediaTemplate EmbedCab="yes"/>

		<Feature Id="ProductFeature" Title="Installer" Level="1">
			<ComponentGroupRef Id="ProductComponents" />
		</Feature>

	  <WixVariable Id="WixUILicenseRtf" Value="license.rtf" />
	</Product>

	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFiles64Folder">
        <Directory Id="Company" Name="JPP Consulting">
				  <Directory Id="INSTALLFOLDER" Name="Ironstone" />
        </Directory>
			</Directory>
		</Directory>
	</Fragment>

	<Fragment>
		<ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
			<!-- <Component Id="ProductComponent"> -->
		  <Component Id="IronstoneCore.dll" Guid="9E579346-97B3-43A5-8AD7-786C8A5BB284" Win64="yes">
		    <File Id="IronstoneCore.dll" Source="..\bin\x64\Release\IronstoneCore.dll" KeyPath="yes" Checksum="yes" ProcessorArchitecture="x64"/>
		  </Component>
      <Component Id="AutoUpdate.NET.dll" Guid="1030798b-fa22-45a3-9b17-58b259fe77e9" Win64="yes">
        <File Id="AutoUpdate.NET.dll" Source="..\bin\x64\Release\Autoupdater.NET.dll" Checksum="yes"/>
      </Component>
		  <Component Id="AutoUpdate.NET.xml" Guid="d7fa9392-6023-409e-8910-3c324033289e" Win64="yes">
		    <File Id="AutoUpdate.NET.xml" Source="..\bin\x64\Release\Autoupdater.NET.xml" Checksum="yes"/>
		  </Component>
		  <Component Id="dpwin64.dll" Guid="26452eb9-3b41-4083-9932-92620f4cd1bb" Win64="yes">
		    <File Id="dpwin64.dll" Source="..\bin\x64\Release\dpwin64.dll" Checksum="yes"/>
		  </Component>
		  <Component Id="Unity.Container.dll" Guid="dfcceb0d-d444-4aa0-89c5-3dd7c581aba3" Win64="yes">
		    <File Id="Unity.Container.dll" Source="..\bin\x64\Release\Unity.Container.dll" Checksum="yes"/>
		  </Component>
		  <Component Id="Unity.Abstractions.dll" Guid="0f4b43b3-fa66-495d-9e88-3694ac21bee0" Win64="yes">
		    <File Id="Unity.Abstractions.dll" Source="..\bin\x64\Release\Unity.Abstractions.dll" Checksum="yes"/>
		  </Component>
		  <Component Id="RegistryEntries" Guid="DBD2BF14-98A3-42C1-867D-72FEFF681867">
		    <RegistryKey Root="HKCU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2000:409\Applications\Ironstone" Action="createAndRemoveOnUninstall">
		      <RegistryValue Type="string" Name="DESCRIPTION" Value="Loader for JPP Ironstone"/>
		      <RegistryValue Type="string" Name="LOADER" Value="[INSTALLFOLDER]IronstoneCore.dll"/>
          <RegistryValue Type="integer" Name="LOADCTRLS" Value="2"/>
		      <RegistryValue Type="integer" Name="MANAGED" Value="1"/>
		    </RegistryKey>
		    <RegistryKey Root="HKCU" Key="Software\Autodesk\AutoCAD\R23.0\ACAD-2001:409\Applications\Ironstone" Action="createAndRemoveOnUninstall">
		      <RegistryValue Type="string" Name="DESCRIPTION" Value="Loader for JPP Ironstone"/>
		      <RegistryValue Type="string" Name="LOADER" Value="[INSTALLFOLDER]IronstoneCore.dll"/>
		      <RegistryValue Type="integer" Name="LOADCTRLS" Value="2"/>
		      <RegistryValue Type="integer" Name="MANAGED" Value="1"/>
		    </RegistryKey>
		  </Component>
			<!-- </Component> -->
		</ComponentGroup>
	</Fragment>
</Wix>
